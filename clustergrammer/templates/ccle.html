<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base href='{{ config["ENTRY_POINT"] }}/'>

    <title>Clustergrammer - CCLE</title>

    <!-- <link rel="shortcut icon" href="static/map-o_32_transparent.ico"  type="image/x-icon"> -->
    <link rel="shortcut icon" href="static/icons/graham_cracker.ico"  type="image/x-icon">

    <!-- Bootstrap Core CSS -->
    <link href="static/lib/css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/lib/css/bootstrap-switch.css">
    <link rel="stylesheet" href="static/css/specific.css" />
    <link rel="stylesheet" href="static/css/custom_ccle.css">
    <link rel="stylesheet" href="static/lib/css/prettify.css">
    <link rel="stylesheet" href="static/css/font-awesome.min.css">

    <style>
      #input_form {display: none}
    </style>

    {% include "ga.html" %}
</head>

<body onload="prettyPrint()">

  <!-- Wrap all page content here -->
  <div id="wrap" class='toggled'>

      <!-- main container - required -->
      <div id='main_container'>

        <!-- this row is - required fluid causes problems -->
        <div class="row" >



          <a href="{{ config["ENTRY_POINT"] }}/">
            <img class='help_figure' id='clustergrammer_logo' src="static/img/clustergrammer_logo.png" alt="Clustergrammer">
          </a>

          <h1 id='website_title'> CCLE Explorer </h1>

          <p class='initial_paragraph first_instructions'>
          The Cancer Cell Line Encyclopedia (CCLE) Explorer enables users to browse relative mRNA expression data for cancer cell lines from the CCLE by tissue of origin using Clustergrammer. Click on a tissue type to view a clustergram of gene expression data from the selected tissue type. </p>

          <!-- non-local mongodb -->
          <div id='tree_container'>
          </div>

          <!-- <a id=demo_link class='blue_links' href="{{ config["ENTRY_POINT"] }}/viz/566f6bbfb1a04e7f4087fcad" target="_blank">See example in full page</a> -->

          <div id='upload_section'>

          <p class='initial_paragraph'>The size of the rectangle indicates the number of cell lines that are available for a tissue-type in the CCLE. The CCLE gene expression data has been Z-score normalized and each tissue subtype clustergram will display the top 500 genes with the most differential expression in the tissue group. </p>

          <a href="help" target="_blank" class="btn share-button" id="help_link"><i class="fa fa-question-circle"></i></a>

          </div>

          <!-- start example row -->
          <!-- <div id='homepage_examples'> -->

            <!-- <p id='example_title'>Clustergrammer Web-App Integration Examples</p> -->

            <!-- <div class='row' >


              <div class='col-xs-4 example_col'>
                <p class='example_single_title'>L1000CDS2</p>
                <a href='{{ config["ORIGIN"] }}{{ config["ENTRY_POINT"] }}/l1000cds2/55e0b68a5bf3665f1a726bfa' target='_blank'>
                  <div class='example_image_container'>
                    <img class='example_image' id='L1000CDS2' src="static/img/L1000CDS2.png" alt="L1000CDS2">
                  </div>
                </a>
                <p class='example_single_description'>Clustergrammer visualizes gene-expression-signature search results from the Ma'ayan lab web tool L1000CDS2, which allows users to find perturbations from the L1000 project whose signatures are similar or antisimilar to their input signature. </p>
              </div>

              <div class='col-xs-4 example_col'>
                <p class='example_single_title'>Enrichr</p>
                <a href='{{ config["ENRICHR_URL"] }}' target='_blank'>
                  <div class='example_image_container'>
                    <img class='example_image' id='Enrichr' src="static/img/Enrichr.png" alt="Enrichr">
                  </div>
                </a>
                <p class='example_single_description'>Clustergrammer visualizes enrichment analysis results from Enrichr. The rows of the matrix are a user's input genes and the columns are the top enriched terms.</p>
              </div>

              <div class='col-xs-4 example_col'>
                <p class='example_single_title'>Harmonogram</p>
                <a href='{{ config['HARMONOGRAM_URL'] }}/' target='_blank'>
                  <div class='example_image_container'>
                    <img class='example_image' id='harmonizome' src="static/img/harmonizome.png" alt="Harmonogram">
                  </div>
                </a>
                <p class='example_single_description'>Clustergrammer visualizes data from over 100 biological resources for the Ma'ayan lab web-resource Harmonogram. </p>
              </div>

            </div> -->
            <!-- end row -->


          <!-- </div> -->

        </div>
        <!-- end row -->


      </div>
      <!-- end main container -->

  </div>
  <!-- End Wrap all page content here -->

  <div id='footer'>
    <div class="row" id='footer-row' >
      <div id='footer_text_container' class="col-xs-12 footer_section">
        <div class="text-muted footer_text">Clustergrammer is being developed by the <a class='blue_links' target="_blank"  href="http://icahn.mssm.edu/research/labs/maayan-laboratory">Ma'ayan Lab</a> at the <a class='blue_links' target="_blank"   href="http://icahn.mssm.edu/">Icahn School of Medicine at Mount Sinai</a>  for the <a target="_blank" href="http://lincs-dcic.org/">BD2K-LINCS DCIC</a> and the <a target="_blank" href="http://commonfund.nih.gov/idg/overview">KMC-IDG</a>  </div>
        <!-- DCIC, BD2K, KMC, and GitHub -->
        <div class="text-muted footer_text">
        and is an open source project available on GitHub: <a class='blue_links' target="_blank"  href="https://github.com/MaayanLab/clustergrammer">Clustergrammer</a> and <a class='blue_links' target="_blank"  href="https://github.com/cornhundred/clustergrammer.js">Clustergrammer.js</a>

        </div>

      </div>
    </div>
  </div>




    <!-- Vendor -->
  <!-- jQuery -->
  <script src="static/lib/js/jquery-1.11.2.min.js"></script>

  <!-- <script src='static/lib/js/jquery.accordion.js'></script> -->
  <!-- Bootstrap Core JavaScript -->
  <script src="static/lib/js/bootstrap.min.js"></script>
  <script src="static/lib/js/bootstrap-switch.min.js"></script>
  <script src="static/lib/js/blockUI.js"></script>
  <script src="static/lib/js/d3.js"></script>

  <!-- stylized file upload button -->
  <!-- http://gregpike.net/demos/bootstrap-file-input/demo.html -->
  <script type="text/javascript" src="static/lib/js/bootstrap.file-input.js"> </script>
  <script type="text/javascript">
    $('input[type=file]').bootstrapFileInput();
    $('.file-inputs').bootstrapFileInput();
  </script>
  <script type="text/javascript" src="static/lib/js/prettify.js"> </script>

  <!-- style code -->
  <!-- Clustergram Scripts -->
  <script src='static/js/d3_clustergram.js'></script>


  <script>


var tree = {
  "children": [
    {
      "mongo_id": "57db082c0329ef78ffc9b490",
      "name": "THYROID",
      "size": 12
    },
    {
      "mongo_id": "57db082e0329ef78ffc9b491",
      "name": "SALIVARY GLAND",
      "size": 2
    },
    {
      "mongo_id": "57db08330329ef78ffc9b492",
      "name": "SOFT TISSUE",
      "size": 21
    },
    {
      "mongo_id": "57db08400329ef78ffc9b493",
      "name": "HAEMATOPOIETIC AND LYMPHOID TISSUE",
      "size": 180
    },
    {
      "mongo_id": "57db08570329ef78ffc9b498",
      "name": "BILIARY TRACT",
      "size": 8
    },
    {
      "mongo_id": "57db08490329ef78ffc9b495",
      "name": "PANCREAS",
      "size": 44
    },
    {
      "mongo_id": "57db08500329ef78ffc9b496",
      "name": "CENTRAL NERVOUS SYSTEM",
      "size": 69
    },
    {
      "mongo_id": "57db08550329ef78ffc9b497",
      "name": "BONE",
      "size": 29
    },
    {
      "mongo_id": "57db08450329ef78ffc9b494",
      "name": "LARGE INTESTINE",
      "size": 61
    },
    {
      "mongo_id": "57db085a0329ef78ffc9b499",
      "name": "AUTONOMIC GANGLIA",
      "size": 17
    },
    {
      "mongo_id": "57db085c0329ef78ffc9b49a",
      "name": "PLEURA",
      "size": 11
    },
    {
      "mongo_id": "57db08600329ef78ffc9b49b",
      "name": "URINARY TRACT",
      "size": 27
    },
    {
      "mongo_id": "57db086b0329ef78ffc9b49c",
      "name": "LUNG",
      "size": 187
    },
    {
      "mongo_id": "57db086f0329ef78ffc9b49d",
      "name": "BREAST",
      "size": 59
    },
    {
      "mongo_id": "57db08730329ef78ffc9b49e",
      "name": "SKIN",
      "size": 62
    },
    {
      "mongo_id": "57db08790329ef78ffc9b49f",
      "name": "OVARY",
      "size": 52
    },
    {
      "mongo_id": "57db087c0329ef78ffc9b4a0",
      "name": "PROSTATE",
      "size": 8
    },
    {
      "mongo_id": "57db08810329ef78ffc9b4a1",
      "name": "KIDNEY",
      "size": 36
    },
    {
      "mongo_id": "57db08850329ef78ffc9b4a2",
      "name": "UPPER AERODIGESTIVE TRACT",
      "size": 32
    },
    {
      "mongo_id": "57db088b0329ef78ffc9b4a3",
      "name": "STOMACH",
      "size": 38
    },
    {
      "mongo_id": "57db088f0329ef78ffc9b4a4",
      "name": "ENDOMETRIUM",
      "size": 27
    },
    {
      "mongo_id": "57db08920329ef78ffc9b4a5",
      "name": "OESOPHAGUS",
      "size": 26
    },
    {
      "mongo_id": "57db08970329ef78ffc9b4a6",
      "name": "LIVER",
      "size": 28
    }
  ]
}

var width = 940, // innerWidth-40
    height = 600, // innerHeight-40,
    color = d3.scale.category20c(),
    div = d3.select("#tree_container").append("div")
       .attr('id','new_div')
       .style("position", "relative");

var treemap = d3.layout.treemap()
    .size([width, height])
    .sticky(true)
    .value(function(d) { return d.size; });


var node = div.datum(tree).selectAll(".node")
      .data(treemap.nodes)
      .enter().append("div")
      .attr("class", "node")
      .on('click',function(d){
        console.log(d.name);
        console.log(d.size);
        console.log(d.mongo_id)
        console.log('\n')
        // location.href='{{ config["ENTRY_POINT"] }}/viz/'+d.mongodb
        qs = '?col_label= CCLE '+  d.name + ' Cell Lines&row_label=Genes'
        redirect_url = '{{ config["ENTRY_POINT"] }}/viz/'+d.mongo_id+'/'+'CCLE: '+d.name+qs;
        window.open(redirect_url, '_blank');

        console.log(redirect_url)
      })
      .attr('title', function(d) { return d.children ? null : d.name; })
      .call(position)
      .style("background-color", function(d) {
          return d.name == 'tree' ? '#fff' : color(d.name); })
      .append('div')
      .style("font-size", function(d) {
          // compute font size based on sqrt(area)
          return Math.max(15, 0.10*Math.sqrt(d.area))+'px'; })
      .text(function(d) { return d.children ? null : d.name; })

function position() {
  this.style("left", function(d) { return d.x + "px"; })
      .style("top", function(d) { return d.y + "px"; })
      .style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
      .style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
}


  </script>
</body>

